<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title th:text="${pageTitle}">MetaMapa</title>
    <link rel="icon" type="image/png" th:href="@{/img/mascota.jpg}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

</head>
<body class="d-flex flex-column min-vh-100">
<!-- Navbar -->
<header class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between p-3 mb-4 border-bottom">
    <div class="d-flex align-items-center">
        <a class="navbar-brand d-flex align-items-center" th:href="@{/}" aria-label="MetaMapa, inicio">
            <img th:src="@{/img/mascota.jpg}" alt="Logo MetaMapa"
                 class="me-2  rounded-circle" style="height:40px;">
            <span class="fw-bold logo-text">MetaMapa</span>
        </a>
    </div>

    <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
        <li><a href="#" class="nav-link px-2" th:href="@{/}">Inicio</a></li>
        <li><a href="#" class="nav-link px-2" th:href="@{/colecciones}">Colecciones</a></li>
        <li><a href="#" class="nav-link px-2" th:href="@{/hechos}">Hechos</a></li>
        <li><a href="#" class="nav-link px-2" th:href="@{/hechos/crear}">Contribuir</a></li>
        <li sec:authorize="hasRole('ADMIN')"><a href="#" class="nav-link px-2" th:href="@{/panel}">Panel de control</a></li>
        <li sec:authorize="hasRole('ADMIN')"><a href="#" class="nav-link px-2" th:href="@{/estadisticas}">Estadísticas</a></li>
    </ul>
    <div class="col-md-3 text-end">

        <!-- Mostrar solo si NO está logueado -->
        <div sec:authorize="!isAuthenticated()">
            <a class="btn btn-outline-primary me-2" th:href="@{/auth/login}">Iniciar sesión</a>
            <a class="btn btn-primary me-2" th:href="@{/auth/signup}">Registrarse</a>
        </div>

        <!-- Mostrar solo si está logueado -->
        <div sec:authorize="isAuthenticated()">
        <span class="me-2 text-primary">
             <span sec:authentication="name"></span>
        </span>
            <form th:action="@{/logout}" method="post" style="display:inline;">
                <button type="submit" class="btn btn-outline-danger btn-sm">Cerrar sesión</button>
            </form>
        </div>

    </div>
</header>

<!-- Contenido dinámico -->
<main class="container my-4 flex-grow-1">
    <div th:replace="${contenido} :: contenido"></div>
    <div th:replace="fragments/toast :: toast"></div>
</main>

<!-- Footer -->
<footer class="py-3 mt-4 border-top">
    <div class="d-flex flex-column align-items-center">
        <ul class="nav justify-content-center">
            <li class="nav-item">
                <span class="text-white">© MetaMapa</span>
            </li>
            <li class="nav-item">
                <span class="nav-link text-white mx-1">•</span>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link text-white mx-1">Privacidad</a>
            </li>
            <li class="nav-item">
                <span class="nav-link text-white mx-1">•</span>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link text-white mx-1">Términos y condiciones</a>
            </li>
            <li class="nav-item">
                <span class="nav-link text-white mx-1">•</span>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link text-white mx-1">Información legal</a>
            </li>
        </ul>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script th:src="@{js/toast.js}"></script>
<script th:src="@{js/solicitudes.js}"></script>
</body>
</html>